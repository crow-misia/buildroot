From 84d5a55d0440e80db47801dde3eeeb320bdb77d3 Mon Sep 17 00:00:00 2001
From: Zenichi Amano <crow.misia@gmail.com>
Date: Wed, 20 Nov 2019 06:27:16 +0900
Subject: [PATCH 1/8] add support CMake

---
 CMakeLists.txt     |  4 ++++
 src/CMakeLists.txt | 41 +++++++++++++++++++++++++++++++++++++++++
 2 files changed, 45 insertions(+)
 create mode 100644 CMakeLists.txt
 create mode 100644 src/CMakeLists.txt

diff --git a/CMakeLists.txt b/CMakeLists.txt
new file mode 100644
index 0000000..23d62fe
--- /dev/null
+++ b/CMakeLists.txt
@@ -0,0 +1,4 @@
+cmake_minimum_required(VERSION 3.13)
+project(momo)
+add_subdirectory(src)
+install(TARGETS momo RUNTIME DESTINATION bin)
diff --git a/src/CMakeLists.txt b/src/CMakeLists.txt
new file mode 100644
index 0000000..b7c860e
--- /dev/null
+++ b/src/CMakeLists.txt
@@ -0,0 +1,41 @@
+set(CMAKE_INCLUDE_CURRENT_DIR ON)
+set(CMAKE_CXX_STANDARD 14)
+set(CMAKE_C_FLAGS "-Wno-macro-redefined -fno-lto -pthread")
+set(CMAKE_C_FLAGS_DEBUG "-g3 -O0 -pg")
+set(CMAKE_C_FLAGS_RELEASE "-DNEBUG")
+
+add_definitions(-DWEBRTC_POSIX)
+add_definitions(-DOPENSSL_IS_BORINGSSL)
+
+option(WEBRTC_USE_X11 "use X11" OFF)
+if(WEBRTC_USE_X11)
+  add_definitions(-DWEBRTC_USE_X11)
+endif()
+
+add_executable(momo
+	main.cpp
+	signal_listener.cpp
+	util.cpp
+	watchdog.cpp
+	ayame/ayame_server.cpp
+	ayame/ayame_websocket_client.cpp
+	p2p/p2p_connection.cpp
+	p2p/p2p_server.cpp
+	p2p/p2p_session.cpp
+	p2p/p2p_websocket_session.cpp
+	rtc/connection.cpp
+	rtc/device_video_capturer.cpp
+	rtc/h264_format.cpp
+	rtc/hw_video_encoder_factory.cpp
+	rtc/manager.cpp
+	rtc/native_buffer.cpp
+	rtc/observer.cpp
+	rtc/scalable_track_source.cpp
+	sdl_renderer/sdl_renderer.cpp
+	sora/sora_server.cpp
+	sora/sora_session.cpp
+	sora/sora_websocket_client.cpp
+	ws/websocket.cpp
+)
+target_link_libraries(momo pthread webrtc dl boost_filesystem boost_system boringssl SDL2)
+
-- 
2.23.0

